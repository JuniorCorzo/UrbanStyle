---
import { CLOUDFLARE_URL } from '@/config/env-config'
import type { ProductSummary } from '@/interface/product.interface'
import { productStore } from '@/state/product.store'
import { computed } from 'nanostores'
import { Image } from 'astro:assets'
import DetailItem from './DetailItem.astro'
import { getProductImage } from '@/lib/getImageByProductId'

interface Props {
	product: ProductSummary
}
const { productId, color, name, price, quantity, size } = Astro.props.product
---

<div
	class="border-border shadow-border flex h-fit flex-col items-center gap-2 rounded-lg border-2 shadow-sm sm:flex-row sm:gap-4"
>
	<div class="h-full">
		<Image
			class="border-border shadow-border aspect-square size-full rounded-t-md border sm:size-32 sm:rounded-l-md sm:shadow"
			src={getProductImage(productId).get()}
			width={128}
			height={128}
			alt={name}
		/>
	</div>
	<div class="flex w-full flex-col justify-between sm:flex-row">
		<div
			class="text-crust border-border flex h-32 flex-col justify-between gap-0 border-b px-2 font-medium sm:border-b-0 sm:px-3 sm:py-2"
		>
			<span class="uppercase tracking-wide">{name}</span>
			<DetailItem label="Color" value={color} />
			<DetailItem label="Talla" value={size} />
			<DetailItem label="Cantidad" value={quantity} />
		</div>
		<div class="flex flex-col items-end justify-center px-2 py-2 font-medium sm:px-3">
			<span
				>{
					Intl.NumberFormat('es-CO', {
						style: 'currency',
						currency: 'COP',
						currencyDisplay: 'code',
					}).format(price * quantity)
				}</span
			>
			<span class="text-sm font-normal"
				>{
					`(${Intl.NumberFormat('es-CO', {
						style: 'decimal',
						minimumFractionDigits: 2,
						maximumFractionDigits: 2,
					}).format(price)} c/u)`
				}</span
			>
		</div>
	</div>
</div>
