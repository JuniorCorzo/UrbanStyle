---
import Layout from '@/layouts/Layout.astro'
import ProductSection from '@/sections/ProductSection.astro'
import RecommendedProductsSection from '@/sections/RecommendedProductsSection.astro'
import { ProductStore } from '@/state/product.store'

const productId = Astro.url.searchParams.get('id')
if (!productId) return Astro.redirect('/home')

const { getProductById } = ProductStore()
const productById = getProductById(productId).get()

if (!productById) return Astro.redirect('/home')
---

<Layout>
	<ProductSection product={productById} />
	<RecommendedProductsSection
		class="mx-auto max-w-7xl px-3 py-7"
		categoryName={productById?.categories[0].name}
	/>
</Layout>
